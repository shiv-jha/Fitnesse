---
Test
---
---
Test
---
!define clientId {UHGSDW02PD}
!define fileType {Provider}
!define DyaTM {201703}
!define YYYYMMDD {20170301}

!define D2_PRV_Data {SNFCT               NET                                       HOSP-A01                                        282N00000X0000000000                            GENERIC OUT  OF COUNTRY HOSP ENT                                                                                                                                                                                                                               000000029   990001                                                                                                           PO BOX 15645                                                                                                                                                                                                        99999                                                                                                                                                                                                                                                                                                                               F                                                                                                                                                                                                      }

!define providerdata {
${clientId}_${fileType}_${YYYYMMDD}_${YYYYMMDD}_${YYYYMMDD}${DyaTM}                                                                                                                                                                                    
$currentdatetime|${D2_PRV_Data}
${clientId}_${fileType}_${YYYYMMDD}_${YYYYMMDD}_${YYYYMMDD}${DyaTM}                                                                                                                                                                                    
${Records_1}
}


!define env {TST}

|Library                                                                                     |
|!-com.optum.hde.fitnesse.fixtures.DatabaseSupport-!|${DW_DB_URL}|${DW_DB_USER}|${DW_DB_PASS}|


!*> 1. !style_green('''This step will FTP the file into inbound directory)
!|script          |File Support                                                                             |
|$currentdatetime=|make id using Time                                    |yyyyMMddHHmmss                    |
|given the        |P.R${fileType}.${clientId}.D${DyaTM}.T120001t.0000001|modc file with content|${providerdata}|
*!

|script                                                                                                                         |
|check|query|select count(*) as count from frmk_stg_fileinfo f where  f.file_name ='$datfilename'|For|1|And Retry|120|times|true|


!|script  |DbTable                                                         |
|query    |select * from frmk_stg_fileinfo  where file_name ='$datfilename'|
|$filekey=|valueofcolumn                     |FILE_KEY                     |

!|script  |DbTable                                               |
|query    |select sub_cli_sk from d_contr where contr_nbr='${fileType}'|
|$sub_cli_sk=|valueofcolumn                |sub_cli_sk                |




|script                                                                                                                      |
|check|query|select process_sts_key from frmk_stg_fileinfo f where f.file_name ='$datfilename'|For|4|And Retry|120|times|true|


|Query:Db Table|select * from cms_mor_v12 where file_key = $filekey and HIC_NBR='${hicnum1}'|${env}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|FILE_KEY      |CLI_SK                                                                      |SUB_CLI_SK |CS_SRC_DATA_SYS_CD|CONTR_NBR  |PAY_DT_YM|HIC_NBR   |BENFY_LST_NM|BENFY_FST_NM|BENFY_INIT|DOB      |SEX|SSN      |AGE_GRP_FEMALE_0_34|AGE_GRP_FEMALE_35_44|AGE_GRP_FEMALE_45_54|AGE_GRP_FEMALE_55_59|AGE_GRP_FEMALE_60_64|AGE_GRP_FEMALE_65_69|AGE_GRP_FEMALE_70_74|AGE_GRP_FEMALE_75_79|AGE_GRP_FEMALE_80_84|AGE_GRP_FEMALE_85_89|AGE_GRP_FEMALE_90_94|AGE_GRP_FEMALE_95_GT|AGE_GRP_MALE_0_34|AGE_GRP_MALE_35_44|AGE_GRP_MALE_45_54|AGE_GRP_MALE_55_59|AGE_GRP_MALE_60_64|AGE_GRP_MALE_65_69|AGE_GRP_MALE_70_74|AGE_GRP_MALE_75_79|AGE_GRP_MALE_80_84|AGE_GRP_MALE_85_89|AGE_GRP_MALE_90_94|AGE_GRP_MALE_95_GT|MCAID_FEMALE_DSBL|MCAID_FEMALE_AGED|MCAID_MALE_DSBL|MCAID_MALE_AGED|ORIG_DSBL_FEMALE|ORIG_DSBL_MALE|HCC001|HCC002|HCC005|HCC007|HCC008|HCC009|HCC010|HCC015|HCC016|HCC017|HCC018|HCC019|HCC021|HCC025|HCC026|HCC027|HCC031|HCC032|HCC033|HCC037|HCC038|HCC044|HCC045|HCC051|HCC052|HCC054|HCC055|HCC067|HCC068|HCC069|HCC070|HCC071|HCC072|HCC073|HCC074|HCC075|HCC077|HCC078|HCC079|HCC080|HCC081|HCC082|HCC083|HCC092|HCC095|HCC096|HCC100|HCC101|HCC104|HCC105|HCC107|HCC108|HCC111|HCC112|HCC119|HCC130|HCC131|HCC132|HCC148|HCC149|HCC150|HCC154|HCC155|HCC157|HCC158|HCC161|HCC164|HCC174|HCC176|HCC177|DSBL_DSES_HCC5|DSBL_DSES_HCC44|DSBL_DSES_HCC51|DSBL_DSES_HCC52|DSBL_DSES_HCC107|DSES_INTERACTIONS_INT1|DSES_INTERACTIONS_INT2|DSES_INTERACTIONS_INT3|DSES_INTERACTIONS_INT4|DSES_INTERACTIONS_INT5|DSES_INTERACTIONS_INT6|FILLER|
|$filekey      |$sub_cli_sk                                                                 |$sub_cli_sk|CS_DW             |${fileType}|${DyaTM} |${hicnum1}|RRRINGTON   |DELEARN     |          |1955-05-29 00:00:00.0|1  |040546529|0                  |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                |0                 |0                 |1                 |0                 |0                 |0                 |0                 |0                 |0                 |0                 |0                 |0                |0                |0              |0              |0               |0             |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0             |0              |0              |0              |0               |0                     |0                     |0                     |0                     |0                     |0                     |      |

|Query:Db Table|select * from cms_mor_v21 where file_key = $filekey  and HIC_NBR='${hicnum2}'|${env}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|FILE_KEY      |CLI_SK                                                                       |SUB_CLI_SK |CS_SRC_DATA_SYS_CD|CONTR_NBR  |PAY_DT_YM|HIC_NBR   |BENFY_LST_NM|BENFY_FST_NM|BENFY_INIT|DOB      |SEX|SSN      |RAS_ESRD_IND_SWITCH|AGE_GRP_FEMALE_0_34|AGE_GRP_FEMALE_35_44|AGE_GRP_FEMALE_45_54|AGE_GRP_FEMALE_55_59|AGE_GRP_FEMALE_60_64|AGE_GRP_FEMALE_65_69|AGE_GRP_FEMALE_70_74|AGE_GRP_FEMALE_75_79|AGE_GRP_FEMALE_80_84|AGE_GRP_FEMALE_85_89|AGE_GRP_FEMALE_90_94|AGE_GRP_FEMALE_95_GT|AGE_GRP_MALE_0_34|AGE_GRP_MALE_35_44|AGE_GRP_MALE_45_54|AGE_GRP_MALE_55_59|AGE_GRP_MALE_60_64|AGE_GRP_MALE_65_69|AGE_GRP_MALE_70_74|AGE_GRP_MALE_75_79|AGE_GRP_MALE_80_84|AGE_GRP_MALE_85_89|AGE_GRP_MALE_90_94|AGE_GRP_MALE_95_GT|MCAID_FEMALE_DSBL|MCAID_FEMALE_AGED|MCAID_MALE_DSBL|MCAID_MALE_AGED|ORIG_DSBL_FEMALE|ORIG_DSBL_MALE|HCC001|HCC002|HCC006|HCC008|HCC009|HCC010|HCC011|HCC012|HCC017|HCC018|HCC019|HCC021|HCC022|HCC023|HCC027|HCC028|HCC029|HCC033|HCC034|HCC035|HCC039|HCC040|HCC046|HCC047|HCC048|HCC051|HCC052|HCC054|HCC055|HCC057|HCC058|HCC070|HCC071|HCC072|HCC073|HCC074|HCC075|HCC076|HCC077|HCC078|HCC079|HCC080|HCC082|HCC083|HCC084|HCC085|HCC086|HCC087|HCC088|HCC096|HCC099|HCC100|HCC103|HCC104|HCC106|HCC107|HCC108|HCC110|HCC111|HCC112|HCC114|HCC115|HCC122|HCC124|HCC134|HCC135|HCC136|HCC137|HCC138|HCC139|HCC140|HCC141|HCC157|HCC158|HCC159|HCC160|HCC161|HCC162|HCC166|HCC167|HCC169|HCC170|HCC173|HCC176|HCC186|HCC188|HCC189|DSBL_DSES_HCC006|DSBL_DSES_HCC034|DSBL_DSES_HCC046|DSBL_DSES_HCC054|DSBL_DSES_HCC055|DSBL_DSES_HCC110|DSBL_DSES_HCC176|CANCER_IMMUNE|CHF_COPD|CHF_RENAL|COPD_CARD_RESP_FAIL|DIABETES_CHF|SEPSIS_CARD_RESP_FAIL|MCAID|ORIG_DSBL|DSBL_DSES_HCC039|DSBL_DSES_HCC077|DSBL_DSES_HCC085|DSBL_DSES_HCC161|ART_OPENINGS_PRESSURE_ULCER|ASP_SPEC_BCT_PNEUM_PRES_ULC|COPD_ASP_SPEC_BCT_PNEUM|DISABLED_PRESSURE_ULCER|SCHIZO_PHRENIA_CHF|SCHIZO_PHRENIA_COPD|SCHIZO_PHRENIA_SEIZURES|SEPSIS_ARTIF_OPENINGS|SEPSIS_ASP_SPEC_BCT_PNEUM|SEPSIS_PRESSURE_ULCER|FILLER|
|$filekey      |$sub_cli_sk                                                                  |$sub_cli_sk|CS_DW             |${fileType}|${DyaTM} |${hicnum2}|RILLIAMS    |DATTHEW     |          |1951-10-21 00:00:00.0|1  |416702617|Y                  |0                  |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                |0                 |0                 |0                 |1                 |0                 |0                 |0                 |0                 |0                 |0                 |0                 |0                |0                |0              |0              |0               |0             |0     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |1     |0     |1     |0     |0     |1     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0               |1               |0               |0               |0               |0               |0               |0            |1       |1        |0                  |0           |0                    |0    |0        |0               |0               |1               |0               |0                          |0                          |0                      |0                      |0                 |0                  |0                      |0                    |0                        |0                    |      |


|Query:Db Table|select * from cms_mor_v22 where file_key = $filekey  and HIC_NBR='${hicnum3}'|${env}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|FILE_KEY      |CLI_SK                                                                       |SUB_CLI_SK |CS_SRC_DATA_SYS_CD|CONTR_NBR  |PAY_DT_YM|HIC_NBR   |BENFY_LST_NM|BENFY_FST_NM|BENFY_INIT|DOB      |SEX|SSN      |AGE_GRP_FEMALE_0_34|AGE_GRP_FEMALE_35_44|AGE_GRP_FEMALE_45_54|AGE_GRP_FEMALE_55_59|AGE_GRP_FEMALE_60_64|AGE_GRP_FEMALE_65_69|AGE_GRP_FEMALE_70_74|AGE_GRP_FEMALE_75_79|AGE_GRP_FEMALE_80_84|AGE_GRP_FEMALE_85_89|AGE_GRP_FEMALE_90_94|AGE_GRP_FEMALE_95_GT|AGE_GRP_MALE_0_34|AGE_GRP_MALE_35_44|AGE_GRP_MALE_45_54|AGE_GRP_MALE_55_59|AGE_GRP_MALE_60_64|AGE_GRP_MALE_65_69|AGE_GRP_MALE_70_74|AGE_GRP_MALE_75_79|AGE_GRP_MALE_80_84|AGE_GRP_MALE_85_89|AGE_GRP_MALE_90_94|AGE_GRP_MALE_95_GT|MCAID_FEMALE_DSBL|MCAID_FEMALE_AGED|MCAID_MALE_DSBL|MCAID_MALE_AGED|ORIG_DSBL_FEMALE|ORIG_DSBL_MALE|HCC001|HCC002|HCC006|HCC008|HCC009|HCC010|HCC011|HCC012|HCC017|HCC018|HCC019|HCC021|HCC022|HCC023|HCC027|HCC028|HCC029|HCC033|HCC034|HCC035|HCC039|HCC040|HCC046|HCC047|HCC048|HCC054|HCC055|HCC057|HCC058|HCC070|HCC071|HCC072|HCC073|HCC074|HCC075|HCC076|HCC077|HCC078|HCC079|HCC080|HCC082|HCC083|HCC084|HCC085|HCC086|HCC087|HCC088|HCC096|HCC099|HCC100|HCC103|HCC104|HCC106|HCC107|HCC108|HCC110|HCC111|HCC112|HCC114|HCC115|HCC122|HCC124|HCC134|HCC135|HCC136|HCC137|HCC157|HCC158|HCC161|HCC162|HCC166|HCC167|HCC169|HCC170|HCC173|HCC176|HCC186|HCC188|HCC189|DSBL_DSES_HCC006|DSBL_DSES_HCC034|DSBL_DSES_HCC046|DSBL_DSES_HCC054|DSBL_DSES_HCC055|DSBL_DSES_HCC110|DSBL_DSES_HCC176|CANCER_IMMUNE|CHF_COPD|CHF_RENAL|COPD_CARD_RESP_FAIL|DIABETES_CHF|SEPSIS_CARD_RESP_FAIL|MCAID|ORIG_DSBL|DSBL_DSES_HCC039|DSBL_DSES_HCC077|DSBL_DSES_HCC085|DSBL_DSES_HCC161|DISABLED_PRESSURE_ULCER|ART_OPENINGS_PRESSURE_ULCER|ASP_SPEC_BCT_PNEUM_PRES_ULC|COPD_ASP_SPEC_BCT_PNEUM|SCHIZO_PHRENIA_CHF|SCHIZO_PHRENIA_COPD|SCHIZO_PHRENIA_SEIZURES|SEPSIS_ARTIF_OPENINGS|SEPSIS_ASP_SPEC_BCT_PNEUM|SEPSIS_PRESSURE_ULCER|FILLER|DSES_INTAC_HCC47G_CNCR|DSES_INTAC_HCC85G_DBTS_MLLT|DSES_INTAC_HCC85G_COPDCF|DSES_INTAC_HCC85G_RNL|DSES_INTAC_GDA_COPDCF|DSES_INTAC_HCC85HCC96|DSES_INTAC_GSUB_ABSEG_PSYC|COPD_CF_ASP_SPC_BCT_PNM|SCHIZO_PHRENIAG_COPD_CF|FILLER1|MOR_REC_TYPE|
|$filekey      |$sub_cli_sk                                                                  |$sub_cli_sk|CS_DW             |${fileType}|${DyaTM} |${hicnum3}|RRRINGTON   |DELEARN     |          |1955-05-29 00:00:00.0|1  |040546529|0                  |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                   |0                |0                 |0                 |1                 |0                 |0                 |0                 |0                 |0                 |0                 |0                 |0                 |0                |0                |0              |0              |0               |0             |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |1     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0     |0               |0               |0               |0               |0               |0               |0               |0            |0       |0        |0                  |0           |0                    |0    |0        |0               |0               |0               |0               |0                      |0                          |0                          |0                      |0                 |0                  |0                      |0                    |0                        |0                    |      |                      |                           |                        |                     |                     |                     |                          |                       |                       |                    |

